<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geoportal Kecamatan Purwokerto Selatan</title>
    
    <!-- External CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
          integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
          crossorigin="">
    <link rel="stylesheet" href="style.css">
    
    <!-- Inline CSS -->
    <style>
        /* ===== VARIABLES ===== */
        :root {
            --primary: #1A5276;
            --secondary: #3498DB;
            --accent: #2ECC71;
            --light-bg: #F8F9FA;
            --light-card: #FFFFFF;
            --light-gray: #ECF0F1;
            --medium-gray: #BDC3C7;
            --dark-gray: #7F8C8D;
            --text-dark: #2C3E50;
            --text-light: #95A5A6;
            --white: #FFFFFF;
            --star-color: #FFD700;
            --star-empty: #E0E0E0;
            --border-radius: 12px;
            --shadow-subtle: 0 4px 12px rgba(0, 0, 0, 0.08);
            --shadow-medium: 0 6px 20px rgba(0, 0, 0, 0.12);
            --shadow-hover: 0 10px 30px rgba(0, 0, 0, 0.15);
        }
        
        /* ===== HERO SECTION ===== */
        .hero {
            padding: 5rem 2rem;
            text-align: center;
            max-width: 100%;
            margin: 2rem 0;
            background: linear-gradient(rgba(26, 82, 118, 0.85), rgba(52, 152, 219, 0.9)),
                        url('https://images.unsplash.com/photo-1519681393784-d120267933ba?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80') center/cover no-repeat;
            border-radius: 0;
            color: var(--white);
            position: relative;
            overflow: hidden;
        }
        
        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 20% 50%, rgba(46, 204, 113, 0.2), transparent 50%),
                        radial-gradient(circle at 80% 20%, rgba(52, 152, 219, 0.2), transparent 50%);
            z-index: 1;
        }
        
        .hero-content {
            position: relative;
            z-index: 2;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .hero h2 {
            font-family: 'Poppins', sans-serif;
            font-weight: 700;
            font-size: 3rem;
            margin-bottom: 1.5rem;
            color: var(--white);
            line-height: 1.2;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        .hero h2 span {
            color: var(--accent);
            background: linear-gradient(45deg, var(--accent), #16A085);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }
        
        .hero p {
            font-size: 1.2rem;
            margin-bottom: 2.5rem;
            color: rgba(255, 255, 255, 0.9);
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            font-weight: 400;
        }
        
        .cta-button {
            display: inline-block;
            background-color: var(--accent);
            color: var(--white);
            padding: 1.2rem 3rem;
            border-radius: 50px;
            text-decoration: none;
            font-weight: 600;
            font-size: 1.2rem;
            box-shadow: 0 8px 20px rgba(46, 204, 113, 0.3);
            transition: all 0.3s ease;
            border: none;
            font-family: 'Poppins', sans-serif;
            position: relative;
            overflow: hidden;
            z-index: 1;
        }
        
        .cta-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 0%;
            height: 100%;
            background-color: #16A085;
            transition: all 0.4s ease;
            z-index: -1;
        }
        
        .cta-button:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 25px rgba(46, 204, 113, 0.4);
        }
        
        .cta-button:hover::before {
            width: 100%;
        }
        
        .cta-button i {
            margin-right: 10px;
            font-size: 1.4rem;
        }

        /* ===== STATS SECTION ===== */
        .stats-section {
            padding: 4rem 2rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            margin-bottom: 4rem;
        }
        
        .section-header {
            text-align: center;
            margin-bottom: 3rem;
        }
        
        .section-title {
            font-family: 'Poppins', sans-serif;
            font-size: 2.5rem;
            color: var(--primary);
            margin-bottom: 1rem;
        }
        
        .section-subtitle {
            color: var(--dark-gray);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .stat-card {
            background: var(--white);
            border-radius: var(--border-radius);
            padding: 2rem;
            box-shadow: var(--shadow-subtle);
            text-align: center;
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-number {
            font-size: 3.5rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 0.5rem;
            font-family: 'Poppins', sans-serif;
        }
        
        .stat-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 0.5rem;
        }
        
        .stat-desc {
            color: var(--text-light);
            font-size: 0.9rem;
            margin-bottom: 1rem;
        }
        
        .stat-badge {
            display: inline-block;
            background: var(--light-gray);
            color: var(--primary);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        /* ===== QUICK ACCESS SECTION ===== */
        .quick-access-section {
            padding: 5rem 2rem;
            background: var(--white);
            max-width: 1200px;
            margin: 0 auto 4rem;
        }
        
        .quick-access-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2rem;
        }
        
        .access-card {
            background: var(--light-bg);
            border-radius: var(--border-radius);
            padding: 2rem;
            transition: all 0.3s ease;
            border: 1px solid var(--light-gray);
            display: flex;
            flex-direction: column;
        }
        
        .access-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-hover);
        }
        
        .card-title {
            font-size: 1.5rem;
            color: var(--primary);
            margin-bottom: 1rem;
            font-family: 'Poppins', sans-serif;
        }
        
        .card-desc {
            color: var(--text-light);
            margin-bottom: 1.5rem;
            flex-grow: 1;
        }
        
        .access-btn {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            background: var(--secondary);
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            width: fit-content;
        }
        
        .access-btn:hover {
            background: #2980b9;
            transform: translateX(5px);
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 992px) {
            .hero h2 { 
                font-size: 2.5rem; 
            }
            
            .stats-grid,
            .quick-access-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .hero {
                padding: 3rem 1rem;
            }
            
            .hero h2 { 
                font-size: 2rem; 
            }
            
            .hero p {
                font-size: 1.1rem;
            }
            
            .stats-grid,
            .quick-access-grid {
                grid-template-columns: 1fr;
            }
            
            .cta-button {
                padding: 1rem 2rem;
                font-size: 1.1rem;
            }
        }
        
        @media (max-width: 480px) {
            .hero {
                padding: 2.5rem 1rem;
            }
            
            .hero h2 {
                font-size: 1.8rem;
            }
            
            .stats-section,
            .quick-access-section {
                padding: 2rem 1rem;
            }
        }
    </style>
</head>
<body>
    <!-- HEADER -->
    <header class="header">
        <div class="logo-container">
            <div class="logo-kecamatan">
                <img src="../img/logo_pwtsel.png" alt="Logo Kecamatan Purwokerto Selatan">
            </div>
            <div class="logo-geoportal">
                <div class="logo-geoportal-icon">
                    <i class="fas fa-map-marked-alt"></i>
                </div>
                <div class="logo-geoportal-text">
                    <div class="logo-geoportal-main">Geoportal</div>
                    <div class="logo-geoportal-tagline">Data Spasial Digital</div>
                </div>
            </div>
        </div>
        
        <nav class="nav">
            <a href="./" class="nav-link active"><i class="fas fa-home"></i> Beranda</a>
            <a href="../Kecamatan/" class="nav-link"><i class="fas fa-map-marked-alt"></i> Peta Kecamatan</a>
            <a href="../teluk/" class="nav-link"><i class="fas fa-water"></i> Peta Desa Teluk</a>
            <a href="../tentang/" class="nav-link"><i class="fas fa-user-circle"></i> Tentang Kami</a>
        </nav>
    </header>

    <!-- HERO SECTION -->
    <section class="hero">
        <div class="hero-content">
            <h2>Portal <span>Data Spasial</span> Terpadu</h2>
            <p>Portal ini menyajikan peta interaktif dan data geospasial wilayah Kecamatan Purwokerto Selatan untuk perencanaan dan pengembangan wilayah. Jelajahi, analisis, dan akses data dengan mudah!</p>
            <a href="#peta-interaktif" class="cta-button"><i class="fas fa-map-marked-alt"></i> Jelajahi Peta</a>
        </div>
    </section>

    <!-- OBJEK KAMI -->
    <section class="features" id="objek-kami">
        <h3><i class="fas fa-landmark"></i> Objek Kami</h3>
        <div class="features-grid">
            <!-- Tempat 1 -->
            <div class="feature-card" data-place="1">
                <div class="place-image">
                    <img src="../img/taman-andhang-pangeran-purwokerto.jpg" alt="Taman Andhang Pangrenan">
                </div>
                <div class="place-rating">
                    <div class="stars">
                        <span class="star filled">â˜…</span>
                        <span class="star filled">â˜…</span>
                        <span class="star filled">â˜…</span>
                        <span class="star filled">â˜…</span>
                        <span class="star">â˜…</span>
                    </div>
                    <span class="rating-value">4.2</span>
                    <span class="review-count">(42 ulasan)</span>
                </div>
                <h4>Taman Andhang Pangrenan Purwokerto</h4>
                <p>Taman rekreasi ini dibangun pada tahun 2017 dengan konsep taman edukasi yang menggabungkan unsur budaya, sejarah, dan lingkungan...</p>
                <div class="place-address">
                    <i class="fas fa-map-marker-alt"></i>
                    <a href="teluk/?lat=-7.4417&lng=109.2385&zoom=16&place=Taman Andhang Pangrenan" class="address-link">Jalan Gerilya Purwokerto Selatan, Jl. Prof. M Yamin I, Windusara...</a>
                </div>
            </div>
            
            <!-- Tempat 2 -->
            <div class="feature-card" data-place="2">
                <div class="place-image">
                    <img src="../img/Taman-Satria-Purwokerto.png" alt="Taman Satria Purwokerto">
                </div>
                <div class="place-rating">
                    <div class="stars">
                        <span class="star filled">â˜…</span>
                        <span class="star filled">â˜…</span>
                        <span class="star filled">â˜…</span>
                        <span class="star filled">â˜…</span>
                        <span class="star filled">â˜…</span>
                    </div>
                    <span class="rating-value">4.8</span>
                    <span class="review-count">(67 ulasan)</span>
                </div>
                <h4>Taman Satria Purwokerto</h4>
                <p>Taman Satria Berkoh Purwokerto merupakan salah satu RTH atau Taman Kota yang sudah 33 tahun menjadi paru-paru kota Purwokerto...</p>
                <div class="place-address">
                    <i class="fas fa-map-marker-alt"></i>
                    <a href="teluk/?lat=-7.4432&lng=109.2401&zoom=16&place=Taman Satria" class="address-link">Kebontebu, Berkoh, Kec. Purwokerto Sel., Kabupaten Banyumas...</a>
                </div>
            </div>
            
            <!-- Tempat 3 -->
            <div class="feature-card" data-place="3">
                <div class="place-image">
                    <img src="../img/Bukit cinta.png" alt="Bukit Cinta">
                </div>
                <div class="place-rating">
                    <div class="stars">
                        <span class="star filled">â˜…</span>
                        <span class="star filled">â˜…</span>
                        <span class="star filled">â˜…</span>
                        <span class="star">â˜…</span>
                        <span class="star">â˜…</span>
                    </div>
                    <span class="rating-value">3.5</span>
                    <span class="review-count">(28 ulasan)</span>
                </div>
                <h4>Bukit Cinta</h4>
                <p>Bukit Cinta merupakan area perbukitan yang sejak lama dikenal oleh warga setempat sebagai tempat berkumpul dan berkegiatan sosial...</p>
                <div class="place-address">
                    <i class="fas fa-map-marker-alt"></i>
                    <a href="teluk/?lat=-7.4398&lng=109.2352&zoom=16&place=Bukit Cinta" class="address-link">G7F4+5RJ, Dusun II Wiradadi, Wiradadi, Kec. Sokaraja...</a>
                </div>
            </div>
            
            <!-- Tempat 4 -->
            <div class="feature-card" data-place="4">
                <div class="place-image">
                    <img src="../img/terminal-pwt.jpeg" alt="Terminal Bulupitu">
                </div>
                <div class="place-rating">
                    <div class="stars">
                        <span class="star filled">â˜…</span>
                        <span class="star filled">â˜…</span>
                        <span class="star">â˜…</span>
                        <span class="star">â˜…</span>
                        <span class="star">â˜…</span>
                    </div>
                    <span class="rating-value">2.8</span>
                    <span class="review-count">(51 ulasan)</span>
                </div>
                <h4>Terminal Bulupitu</h4>
                <p>Terminal Bulupitu di Purwokerto secara resmi berdiri pada 6 April 2006, ketika terminal bus dipindahkan dari lokasi lama ke Bulupitu...</p>
                <div class="place-address">
                    <i class="fas fa-map-marker-alt"></i>
                    <a href="teluk/?lat=-7.4465&lng=109.2428&zoom=16&place=Terminal Bulupitu" class="address-link">H744+HHM, Karanggayam, Teluk, Kec. Purwokerto Sel....</a>
                </div>
            </div>
        </div>
    </section>

    <!-- STATS SECTION -->
    <section class="stats-section">
        <div class="section-header">
            <h2 class="section-title">Data Spasial Kecamatan Purwokerto Selatan</h2>
            <p class="section-subtitle">Ringkasan data geografis dan informasi wilayah dalam satu platform</p>
        </div>
        
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-content">
                    <div class="stat-number" data-count="7">0</div>
                    <div class="stat-title">Desa di Kecamatan</div>
                    <div class="stat-desc">Wilayah administratif</div>
                </div>
                <div class="stat-badge">Terdata</div>
            </div>

            <div class="stat-card">
                <div class="stat-content">
                    <div class="stat-number" data-count="353">0</div>
                    <div class="stat-title">Jumlah RT</div>
                    <div class="stat-desc">Rukun Tetangga</div>
                </div>
                <div class="stat-badge">Unit</div>
            </div>

            <div class="stat-card">
                <div class="stat-content">
                    <div class="stat-number" data-count="74">0</div>
                    <div class="stat-title">Jumlah RW</div>
                    <div class="stat-desc">Rukun Warga</div>
                </div>
                <div class="stat-badge">Unit</div>
            </div>

            <div class="stat-card">
                <div class="stat-content">
                    <div class="stat-number" data-count="74.305">0</div>
                    <div class="stat-title">Jumlah Penduduk</div>
                    <div class="stat-desc">Informasi geografis lengkap</div>
                </div>
                <div class="stat-badge">Tersedia</div>
            </div>
        </div>
    </section>

    <!-- PETA INTERAKTIF -->
    <section class="map-preview" id="peta-interaktif">
        <h3><i class="fas fa-map-signs"></i> Peta Interaktif</h3>
        <div class="map-container">
            <div class="map-header">
                <h4><i class="fas fa-map"></i> Peta Wilayah Kecamatan Purwokerto Selatan</h4>
                <div class="map-actions">
                     <button class="map-action-btn" id="reloadMap">
            <i class="fas fa-sync-alt"></i> Reload Peta
        </button>
        <button class="map-action-btn" id="openFullscreen">
            <i class="fas fa-expand"></i> Layar Penuh
        </button>
        <button class="map-action-btn" id="openInNewWindow">
            <i class="fas fa-external-link-alt"></i> Buka di Tab Baru
        </button>
        <button class="map-action-btn" id="downloadMap">
            <i class="fas fa-download"></i> Download
        </button>
                </div>
            </div>
             <!-- TEMPATKAN IFRAME PETA QGIS DI SINI -->
           <div class="map-frame-wrapper">
    <iframe 
        src="Kelurahan/index.html" 
        id="qgisMap"
        class="qgis-iframe"
        title="Peta QGIS Kecamatan Purwokerto Selatan">
    </iframe>
    <div class="iframe-overlay"></div>
</div>
        </div>
            
            <div class="map-info">
                <h5>Desa Teluk - Peta Interaktif</h5>
                
            <div class="map-links">
                <a href="Kelurahan/index.html" target="_blank" class="map-link-btn">
                    <i class="fas fa-mountain"></i> Peta Kecamatan Lengkap
                </a>
                <button onclick="refreshMap()" class="map-link-btn outline">
                    <i class="fas fa-sync"></i> Refresh Peta
                </button>
            </div>
                <div class="map-links">
                    <a href="../Kecamatan/" class="map-link-btn">
                        <i class="fas fa-mountain"></i> Peta Kecamatan Lengkap
                    </a>
                    <a href="../teluk/" class="map-link-btn outline">
                        <i class="fas fa-water"></i> Detail Peta Desa Teluk
                    </a>
                </div>
            </div>
        </div>
    </section>

    <!-- QUICK ACCESS -->
    <section class="quick-access-section">
        <div class="section-header">
            <h2 class="section-title">Akses Cepat</h2>
            <p class="section-subtitle">Temukan informasi yang Anda butuhkan dengan cepat dan mudah</p>
        </div>
        
        <div class="quick-access-grid">
            <div class="access-card">
                <h3 class="card-title">Peta Kecamatan</h3>
                <p class="card-desc">Akses peta lengkap seluruh wilayah kecamatan dengan 7 desa dan informasi detail setiap wilayah</p>
                <a href="../Kecamatan/" class="access-btn">
                    <span>Buka Peta</span>
                    <i class="fas fa-arrow-right"></i>
                </a>
            </div>
            
            <div class="access-card">
                <h3 class="card-title">Peta Desa Teluk</h3>
                <p class="card-desc">Detail peta Desa Teluk dengan data spasial lengkap, batas wilayah, dan fasilitas publik</p>
                <a href="../teluk/" class="access-btn">
                    <span>Eksplorasi</span>
                    <i class="fas fa-arrow-right"></i>
                </a>
            </div>
            
            <div class="access-card">
                <h3 class="card-title">Objek Wisata</h3>
                <p class="card-desc">Temukan objek wisata dan tempat bersejarah di wilayah kami dengan informasi lengkap</p>
                <a href="#" class="access-btn">
                    <span>Jelajahi</span>
                    <i class="fas fa-arrow-right"></i>
                </a>
            </div>
            
            <div class="access-card">
                <h3 class="card-title">Tentang Kami</h3>
                <p class="card-desc">Pelajari lebih lanjut tentang pengembang, visi misi, dan tujuan dari geoportal ini</p>
                <a href="../tentang/" class="access-btn">
                    <span>Selengkapnya</span>
                    <i class="fas fa-arrow-right"></i>
                </a>
            </div>
        </div>
        <!-- MODAL DETAIL OBJEK -->
<div class="modal" id="placeModal">
    <div class="modal-content">
        <div class="modal-header">
            <h3 id="modalPlaceName">Detail Objek</h3>
            <button class="close-modal" id="closeModal">&times;</button>
        </div>
        
        <div class="modal-body">
            <!-- Gambar Utama -->
            <div class="modal-image-container">
                <img id="modalPlaceImage" src="" alt="Gambar Tempat">
            </div>
            
            <!-- Info Rating -->
            <div class="modal-rating">
                <div class="rating-display">
                    <div class="rating-stars" id="modalStars">
                        <span class="star">â˜…</span>
                        <span class="star">â˜…</span>
                        <span class="star">â˜…</span>
                        <span class="star">â˜…</span>
                        <span class="star">â˜…</span>
                    </div>
                    <span class="rating-value" id="modalRating">4.5</span>
                    <span class="review-count" id="modalReviewCount">(42 ulasan)</span>
                </div>
            </div>
            
            <!-- Deskripsi -->
            <div class="modal-description">
                <h4>Deskripsi</h4>
                <p id="modalPlaceDescription">Deskripsi tempat akan muncul di sini...</p>
            </div>
            
            <!-- Alamat -->
            <div class="modal-address">
                <h4><i class="fas fa-map-marker-alt"></i> Alamat</h4>
                <p id="modalPlaceAddress">Alamat lengkap akan muncul di sini...</p>
            </div>
            
            <!-- Fasilitas -->
            <div class="modal-facilities">
                <h4><i class="fas fa-utensils"></i> Fasilitas</h4>
                <div class="facilities-list" id="modalFacilities">
                    <span class="facility-tag">Parkir</span>
                    <span class="facility-tag">Toilet</span>
                    <span class="facility-tag">Taman</span>
                    <span class="facility-tag">Area Bermain</span>
                </div>
            </div>
            
            <!-- Jam Operasional -->
            <div class="modal-hours">
                <h4><i class="fas fa-clock"></i> Jam Operasional</h4>
                <p id="modalHours">24 Jam (Setiap Hari)</p>
            </div>
            
            <!-- Tombol Aksi -->
            <div class="modal-actions">
                <button class="modal-btn btn-primary" id="viewOnMapBtn">
                    <i class="fas fa-map-marked-alt"></i> Lihat di Peta
                </button>
                <button class="modal-btn btn-secondary" id="directionsBtn">
                    <i class="fas fa-directions"></i> Petunjuk Arah
                </button>
                <button class="modal-btn btn-close" id="closeModalBtn">
                    <i class="fas fa-times"></i> Tutup
                </button>
            </div>
        </div>
    </div>
</div>
    </section>

    <!-- FOOTER -->
    <footer class="footer">
        <p>Dibuat menggunakan QGIS & Leaflet</p>
        <p>Â© <span id="current-year">2025</span> Geoportal Kecamatan Purwokerto Selatan</p>
        <div class="footer-links">
            <a href="https://github.com/tiapmo" target="_blank"><i class="fab fa-github"></i> GitHub</a>
            <a href="mailto:contoh@email.com"><i class="fas fa-envelope"></i> Kontak</a>
            <a href="../tentang/"><i class="fas fa-user-circle"></i> Tentang Kami</a>
        </div>
    </footer>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
            crossorigin=""></script>

    <script>
        // Data untuk peta
       // ===== DATA DETAIL OBJEK =====
const placesData = {
    1: {
        name: "Taman Andhang Pangrenan Purwokerto",
        image: "../img/taman-andhang-pangeran-purwokerto.jpg",
        description: "Taman rekreasi ini dibangun pada tahun 2017 dengan konsep taman edukasi yang menggabungkan unsur budaya, sejarah, dan lingkungan. Nama taman ini berasal dari bahasa Jawa yang berarti 'taman yang mengajarkan' atau 'taman yang memberi petunjuk'. Taman ini menjadi salah satu ruang publik favorit warga Purwokerto untuk bersantai dan beraktivitas. Fasilitas yang tersedia meliputi area bermain anak, jogging track, taman bunga, dan ruang terbuka untuk berbagai kegiatan masyarakat.",
        address: "Jalan Gerilya Purwokerto Selatan, Jl. Prof. M Yamin I, Windusara, Karangklesem, Kec. Banyumas, Kabupaten Banyumas, Jawa Tengah 53144",
        mapLink: "teluk/?lat=-7.4417&lng=109.2385&zoom=16&place=Taman Andhang Pangrenan",
        rating: 4.2,
        reviewCount: 42,
        facilities: ["Parkir Luas", "Area Bermain Anak", "Jogging Track", "Taman Bunga", "Toilet", "Mushola", "Warung Makan"],
        hours: "05:00 - 22:00 WIB (Setiap Hari)"
    },
    2: {
        name: "Taman Satria Purwokerto",
        image: "../img/Taman-Satria-Purwokerto.png",
        description: "Taman Satria Berkoh Purwokerto merupakan salah satu RTH atau Taman Kota yang sudah 33 tahun menjadi paru-paru kota Purwokerto. Taman Satria Berkoh Purwokerto diresmikan pada Rabu, 15 Januari 1992 oleh Bupati KDH TK.II Banyumas Djoko Sudantoko. Taman ini memiliki fasilitas lengkap termasuk area bermain anak, jogging track, dan area pertemuan masyarakat. Taman ini sering menjadi lokasi kegiatan sosial, olahraga, dan rekreasi keluarga di akhir pekan.",
        address: "Kebontebu, Berkoh, Kec. Purwokerto Sel., Kabupaten Banyumas, Jawa Tengah 53146",
        mapLink: "teluk/?lat=-7.4432&lng=109.2401&zoom=16&place=Taman Satria",
        rating: 4.8,
        reviewCount: 67,
        facilities: ["Parkir", "Area Bermain", "Jogging Track", "Fitness Area", "Toilet", "Lapangan Olahraga", "Food Court"],
        hours: "24 Jam (Setiap Hari)"
    },
    3: {
        name: "Bukit Cinta",
        image: "../img/Bukit cinta.png",
        description: "Bukit Cinta merupakan area perbukitan yang sejak lama dikenal oleh warga setempat sebagai tempat berkumpul dan berkegiatan sosial, terutama bagi generasi muda. Dari kebiasaan inilah tempat ini mendapat nama 'Bukit Cinta'. Tempat ini menawarkan pemandangan kota Purwokerto yang indah, terutama saat sore dan malam hari. Meskipun tidak memiliki fasilitas yang lengkap, keindahan alam dan udara segar membuat tempat ini tetap populer dikunjungi.",
        address: "G7F4+5RJ, Dusun II Wiradadi, Wiradadi, Kec. Sokaraja, Kabupaten Banyumas, Jawa Tengah 53181",
        mapLink: "teluk/?lat=-7.4398&lng=109.2352&zoom=16&place=Bukit Cinta",
        rating: 3.5,
        reviewCount: 28,
        facilities: ["Area Parkir", "Spot Foto", "Warung Kaki Lima"],
        hours: "24 Jam (Setiap Hari)"
    },
    4: {
        name: "Terminal Bulupitu",
        image: "../img/terminal-pwt.jpeg",
        description: "Terminal Bulupitu di Purwokerto secara resmi berdiri pada 6 April 2006, ketika terminal bus dipindahkan dari lokasi lama ke Bulupitu sebagai terminal tipe A yang melayani angkutan kota, pedesaan, serta angkutan antarkota dalam dan antar provinsi. Terminal ini menjadi pusat transportasi utama di wilayah Banyumas dan sekitarnya. Meskipun lebih berfungsi sebagai terminal transportasi, bangunannya memiliki nilai sejarah sebagai titik penting perkembangan transportasi di Purwokerto.",
        address: "H744+HHM, Karanggayam, Teluk, Kec. Purwokerto Sel., Kabupaten Banyumas, Jawa Tengah 53145",
        mapLink: "teluk/?lat=-7.4465&lng=109.2428&zoom=16&place=Terminal Bulupitu",
        rating: 2.8,
        reviewCount: 51,
        facilities: ["Terminal Bus", "Parkir", "Toilet", "Kios Makanan", "Loket Tiket", "Ruang Tunggu"],
        hours: "04:00 - 22:00 WIB (Setiap Hari)"
    }
};

// ===== FUNGSI UTAMA =====
document.addEventListener('DOMContentLoaded', function() {
    // 1. Inisialisasi Peta
    initMap();
    
    // 2. Setup Modal
    setupModal();
    
    // 3. Setup lainnya
    setupFeatures();
    
    // 4. Update tahun footer
    document.getElementById('current-year').textContent = new Date().getFullYear();
});

// ===== FUNGSI PETA =====
function initMap() {
    const places = [
        {
            name: "Taman Andhang Pangrenan Purwokerto",
            lat: -7.4417,
            lng: 109.2385,
            description: "Taman rekreasi dengan konsep taman edukasi yang menggabungkan unsur budaya, sejarah, dan lingkungan.",
            link: "teluk/?lat=-7.4417&lng=109.2385&zoom=16&place=Taman Andhang Pangrenan"
        },
        {
            name: "Taman Satria Purwokerto",
            lat: -7.4432,
            lng: 109.2401,
            description: "Taman Kota yang sudah 33 tahun menjadi paru-paru kota Purwokerto.",
            link: "teluk/?lat=-7.4432&lng=109.2401&zoom=16&place=Taman Satria"
        },
        {
            name: "Bukit Cinta",
            lat: -7.4398,
            lng: 109.2352,
            description: "Area perbukitan yang menawarkan pemandangan kota Purwokerto yang indah.",
            link: "teluk/?lat=-7.4398&lng=109.2352&zoom=16&place=Bukit Cinta"
        },
        {
            name: "Terminal Bulupitu",
            lat: -7.4465,
            lng: 109.2428,
            description: "Terminal tipe A yang melayani angkutan kota, pedesaan, serta angkutan antarkota.",
            link: "teluk/?lat=-7.4465&lng=109.2428&zoom=16&place=Terminal Bulupitu"
        }
    ];

    const map = L.map('mainMap').setView([-7.4444, 109.2390], 14);
    
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);
    
    places.forEach(place => {
        const marker = L.marker([place.lat, place.lng]).addTo(map);
        marker.bindPopup(`
            <div style="min-width: 200px;">
                <h4 style="margin: 0 0 10px 0; color: #1A5276;">${place.name}</h4>
                <p style="margin: 0 0 10px 0; font-size: 14px;">${place.description}</p>
                <a href="${place.link}" style="background: #3498DB; color: white; padding: 5px 10px; border-radius: 4px; text-decoration: none; font-size: 14px; display: inline-block;">
                    Lihat Detail
                </a>
            </div>
        `);
        
        marker.on('click', function() {
            map.setView([place.lat, place.lng], 16);
        });
    });
    
    L.circle([-7.4444, 109.2390], {
        color: '#3498DB',
        fillColor: '#3498DB',
        fillOpacity: 0.1,
        radius: 1000
    }).addTo(map).bindPopup('Wilayah Kecamatan Purwokerto Selatan');
    
    L.control.zoom({
        position: 'topright'
    }).addTo(map);
    
    document.getElementById('resetView').addEventListener('click', function() {
        map.setView([-7.4444, 109.2390], 14);
    });
    
    document.getElementById('locateMe').addEventListener('click', function() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(function(position) {
                map.setView([position.coords.latitude, position.coords.longitude], 16);
                L.marker([position.coords.latitude, position.coords.longitude])
                    .addTo(map)
                    .bindPopup('Lokasi Anda Saat Ini')
                    .openPopup();
            });
        } else {
            alert('Geolocation tidak didukung oleh browser Anda.');
        }
    });
}

// ===== FUNGSI MODAL =====
function setupModal() {
    const modal = document.getElementById('placeModal');
    const closeModalBtn = document.getElementById('closeModal');
    const closeModalBtn2 = document.getElementById('closeModalBtn');
    const viewOnMapBtn = document.getElementById('viewOnMapBtn');
    const directionsBtn = document.getElementById('directionsBtn');
    
    let currentPlaceData = null;
    
    // Fungsi buka modal
    function openModal(placeId) {
        const placeData = placesData[placeId];
        if (!placeData) return;
        
        currentPlaceData = placeData;
        
        // Isi data ke modal
        document.getElementById('modalPlaceName').textContent = placeData.name;
        document.getElementById('modalPlaceImage').src = placeData.image;
        document.getElementById('modalPlaceImage').alt = placeData.name;
        document.getElementById('modalPlaceDescription').textContent = placeData.description;
        document.getElementById('modalPlaceAddress').textContent = placeData.address;
        document.getElementById('modalRating').textContent = placeData.rating;
        document.getElementById('modalReviewCount').textContent = `(${placeData.reviewCount} ulasan)`;
        document.getElementById('modalHours').textContent = placeData.hours;
        
        // Update rating stars
        updateStars(placeData.rating);
        
        // Update fasilitas
        updateFacilities(placeData.facilities);
        
        // Tampilkan modal
        modal.style.display = 'flex';
        document.body.style.overflow = 'hidden';
    }
    
    // Fungsi update bintang
    function updateStars(rating) {
        const starsContainer = document.getElementById('modalStars');
        const stars = starsContainer.querySelectorAll('.star');
        const fullStars = Math.floor(rating);
        const hasHalfStar = rating % 1 >= 0.5;
        
        stars.forEach((star, index) => {
            if (index < fullStars) {
                star.style.color = '#FFD700';
                star.style.opacity = '1';
            } else if (index === fullStars && hasHalfStar) {
                star.style.color = '#FFD700';
                star.style.opacity = '0.6';
            } else {
                star.style.color = '#E0E0E0';
                star.style.opacity = '1';
            }
        });
    }
    
    // Fungsi update fasilitas
    function updateFacilities(facilities) {
        const container = document.getElementById('modalFacilities');
        container.innerHTML = '';
        
        facilities.forEach(facility => {
            const tag = document.createElement('span');
            tag.className = 'facility-tag';
            tag.textContent = facility;
            container.appendChild(tag);
        });
    }
    
    // Fungsi tutup modal
    function closeModal() {
        modal.style.display = 'none';
        document.body.style.overflow = 'auto';
        currentPlaceData = null;
    }
    
    // Event listener untuk tombol di modal
    closeModalBtn.addEventListener('click', closeModal);
    closeModalBtn2.addEventListener('click', closeModal);
    
    viewOnMapBtn.addEventListener('click', function() {
        if (currentPlaceData && currentPlaceData.mapLink) {
            window.open(currentPlaceData.mapLink, '_blank');
        }
    });
    
    directionsBtn.addEventListener('click', function() {
        if (currentPlaceData) {
            const address = encodeURIComponent(currentPlaceData.address);
            window.open(`https://www.google.com/maps/dir/?api=1&destination=${address}`, '_blank');
        }
    });
    
    // Tutup modal saat klik di luar
    modal.addEventListener('click', function(e) {
        if (e.target === modal) {
            closeModal();
        }
    });
    
    // Tutup modal dengan ESC
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape' && modal.style.display === 'flex') {
            closeModal();
        }
    });
    
    // Kembalikan fungsi openModal untuk digunakan di luar
    window.openPlaceModal = openModal;
}

// ===== FUNGSI FITUR CARD =====
function setupFeatures() {
    const featureCards = document.querySelectorAll('.feature-card');
    
    featureCards.forEach(card => {
        card.addEventListener('click', function(e) {
            // Cegah jika mengklik link
            if (e.target.tagName === 'A' || e.target.closest('a')) {
                return;
            }
            
            const placeId = this.getAttribute('data-place');
            if (placeId && window.openPlaceModal) {
                window.openPlaceModal(placeId);
            }
        });
    });
    
    // Animasi counter untuk stats
    const counters = document.querySelectorAll('.stat-number');
    counters.forEach(counter => {
        const target = +counter.getAttribute('data-count');
        const increment = target / 100;
        let current = 0;
        
        const updateCounter = () => {
            if (current < target) {
                current += increment;
                counter.textContent = Math.ceil(current);
                setTimeout(updateCounter, 20);
            } else {
                counter.textContent = target;
            }
        };
        
        // Mulai animasi setelah 500ms
        setTimeout(updateCounter, 500);
    });
    
    // Smooth scrolling
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function(e) {
            e.preventDefault();
            const targetId = this.getAttribute('href');
            if (targetId === '#') return;
            const targetElement = document.querySelector(targetId);
            if (targetElement) {
                window.scrollTo({
                    top: targetElement.offsetTop - 80,
                    behavior: 'smooth'
                });
            }
        });
    });
}

        // Inisialisasi aplikasi
        document.addEventListener('DOMContentLoaded', function() {
            // Inisialisasi peta
            const map = L.map('mainMap').setView([-7.4444, 109.2390], 14);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '&copy; OpenStreetMap contributors'
            }).addTo(map);
            
            // Tambahkan marker
            places.forEach(place => {
                const marker = L.marker([place.lat, place.lng]).addTo(map);
                marker.bindPopup(`
                    <div style="min-width: 200px;">
                        <h4 style="margin: 0 0 10px 0; color: #1A5276;">${place.name}</h4>
                        <p style="margin: 0 0 10px 0; font-size: 14px;">${place.description}</p>
                        <a href="${place.link}" style="background: #3498DB; color: white; padding: 5px 10px; border-radius: 4px; text-decoration: none; font-size: 14px; display: inline-block;">
                            Lihat Detail
                        </a>
                    </div>
                `);
                
                marker.on('click', function() {
                    map.setView([place.lat, place.lng], 16);
                });
            });
            
            // Lingkaran wilayah
            L.circle([-7.4444, 109.2390], {
                color: '#3498DB',
                fillColor: '#3498DB',
                fillOpacity: 0.1,
                radius: 1000
            }).addTo(map).bindPopup('Wilayah Kecamatan Purwokerto Selatan');
            
            // Kontrol zoom
            L.control.zoom({
                position: 'topright'
            }).addTo(map);
            
            // Event listener untuk tombol
            document.getElementById('resetView').addEventListener('click', function() {
                map.setView([-7.4444, 109.2390], 14);
            });
            
            document.getElementById('locateMe').addEventListener('click', function() {
                if (navigator.geolocation) {
                    navigator.geolocation.getCurrentPosition(function(position) {
                        map.setView([position.coords.latitude, position.coords.longitude], 16);
                        L.marker([position.coords.latitude, position.coords.longitude])
                            .addTo(map)
                            .bindPopup('Lokasi Anda Saat Ini')
                            .openPopup();
                    });
                } else {
                    alert('Geolocation tidak didukung oleh browser Anda.');
                }
            });
            
            // Update tahun di footer
            document.getElementById('current-year').textContent = new Date().getFullYear();
            
            // Animasi counter
            const counters = document.querySelectorAll('.stat-number');
            counters.forEach(counter => {
                const target = +counter.getAttribute('data-count');
                const increment = target / 100;
                let current = 0;
                
                const updateCounter = () => {
                    if (current < target) {
                        current += increment;
                        counter.textContent = Math.ceil(current);
                        setTimeout(updateCounter, 20);
                    } else {
                        counter.textContent = target;
                    }
                };
                
                updateCounter();
            });
        });
        // JavaScript untuk kontrol iframe
document.addEventListener('DOMContentLoaded', function() {
    const iframe = document.getElementById('qgisMap');
    const reloadBtn = document.getElementById('reloadMap');
    const fullscreenBtn = document.getElementById('openFullscreen');
    const newWindowBtn = document.getElementById('openInNewWindow');
    const downloadBtn = document.getElementById('downloadMap');
    const mapFrame = document.querySelector('.map-frame-wrapper');
    
    // 1. RELOAD/REFRESH MAP
    reloadBtn.addEventListener('click', function() {
        // Tambahkan parameter timestamp untuk menghindari cache
        const timestamp = new Date().getTime();
        const currentSrc = iframe.src.split('?')[0];
        iframe.src = currentSrc + '?refresh=' + timestamp;
        
        // Animasi tombol
        const icon = this.querySelector('i');
        icon.style.transform = 'rotate(360deg)';
        setTimeout(() => {
            icon.style.transform = 'rotate(0deg)';
        }, 500);
        
        console.log('ðŸ”„ Peta direfresh');
    });
    
    // 2. FULLSCREEN FUNCTIONALITY
    fullscreenBtn.addEventListener('click', function() {
        if (!document.fullscreenElement) {
            // Masuk ke mode fullscreen
            if (mapFrame.requestFullscreen) {
                mapFrame.requestFullscreen();
            } else if (mapFrame.webkitRequestFullscreen) { // Safari
                mapFrame.webkitRequestFullscreen();
            } else if (mapFrame.msRequestFullscreen) { // IE/Edge
                mapFrame.msRequestFullscreen();
            }
            this.innerHTML = '<i class="fas fa-compress"></i> Keluar Fullscreen';
        } else {
            // Keluar dari mode fullscreen
            if (document.exitFullscreen) {
                document.exitFullscreen();
            } else if (document.webkitExitFullscreen) { // Safari
                document.webkitExitFullscreen();
            } else if (document.msExitFullscreen) { // IE/Edge
                document.msExitFullscreen();
            }
            this.innerHTML = '<i class="fas fa-expand"></i> Layar Penuh';
        }
    });
    
    // 3. BUKA DI TAB BARU
    newWindowBtn.addEventListener('click', function() {
        window.open('Kelurahan/index.html', '_blank', 'noopener,noreferrer');
    });
    
    // 4. DOWNLOAD PETA (PNG files)
    downloadBtn.addEventListener('click', function() {
        // Tampilkan dialog download
        const downloadMenu = document.createElement('div');
        downloadMenu.className = 'download-menu';
        downloadMenu.innerHTML = `
            <div class="download-options">
                <h5>Download Peta Desa</h5>
                <ul>
                    <li><a href="Kelurahan/Nama_DesaBerkoh_8.png" download="Desa_Berkoh.png">Desa Berkoh</a></li>
                    <li><a href="Kelurahan/Nama_DesaKarangklesem_3.png" download="Desa_Karangklesem.png">Desa Karangklesem</a></li>
                    <li><a href="Kelurahan/Nama_DesaKarangpucung_2.png" download="Desa_Karangpucung.png">Desa Karangpucung</a></li>
                    <li><a href="Kelurahan/Nama_DesaPwtKidul_5.png" download="Desa_Pwt_Kidul.png">Desa Purwokerto Kidul</a></li>
                    <li><a href="Kelurahan/Nama_DesaPwtKulon_6.png" download="Desa_Pwt_Kulon.png">Desa Purwokerto Kulon</a></li>
                    <li><a href="Kelurahan/Nama_DesaTanjung_7.png" download="Desa_Tanjung.png">Desa Tanjung</a></li>
                    <li><a href="Kelurahan/Nama_DesaTeluk_4.png" download="Desa_Teluk.png">Desa Teluk</a></li>
                    <li><a href="Kelurahan/bataskecamatan_1.png" download="Batas_Kecamatan.png">Batas Kecamatan</a></li>
                </ul>
                <button class="close-download">Tutup</button>
            </div>
        `;
        
        // Style untuk menu download
        downloadMenu.style.cssText = `
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        `;
        
        downloadMenu.querySelector('.download-options').style.cssText = `
            background: white;
            padding: 20px;
            border-radius: 10px;
            max-width: 400px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        `;
        
        document.body.appendChild(downloadMenu);
        
        // Tutup menu
        downloadMenu.querySelector('.close-download').addEventListener('click', function() {
            document.body.removeChild(downloadMenu);
        });
        
        // Tutup saat klik di luar
        downloadMenu.addEventListener('click', function(e) {
            if (e.target === downloadMenu) {
                document.body.removeChild(downloadMenu);
            }
        });
    });
    
    // 5. EVENT LISTENER UNTUK FULLSCREEN CHANGE
    document.addEventListener('fullscreenchange', updateFullscreenButton);
    document.addEventListener('webkitfullscreenchange', updateFullscreenButton);
    document.addEventListener('msfullscreenchange', updateFullscreenButton);
    
    function updateFullscreenButton() {
        if (!document.fullscreenElement && 
            !document.webkitFullscreenElement && 
            !document.msFullscreenElement) {
            fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i> Layar Penuh';
        }
    }
    
    // 6. LOADING INDICATOR UNTUK IFRAME
    iframe.addEventListener('load', function() {
        console.log('âœ… Peta QGIS berhasil dimuat');
        // Tambahkan kelas loaded untuk animasi
        iframe.classList.add('loaded');
        
        // Coba komunikasi dengan iframe (jika same-origin)
        try {
            setTimeout(() => {
                iframe.contentWindow.postMessage({ type: 'hello', message: 'Parent loaded' }, '*');
            }, 1000);
        } catch (e) {
            console.log('â„¹ï¸ Tidak bisa mengirim pesan ke iframe (mungkin cross-origin)');
        }
    });
    
    iframe.addEventListener('error', function() {
        console.error('âŒ Gagal memuat peta dari iframe');
        // Tampilkan pesan error
        const errorDiv = document.createElement('div');
        errorDiv.innerHTML = `
            <div style="padding: 20px; text-align: center;">
                <i class="fas fa-exclamation-triangle" style="color: #e74c3c; font-size: 2em; margin-bottom: 10px;"></i>
                <h4>Gagal Memuat Peta</h4>
                <p>File peta tidak dapat dimuat. Pastikan folder "Kelurahan" ada dan berisi file index.html</p>
                <button onclick="location.reload()" style="margin-top: 10px; padding: 10px 20px; background: #3498db; color: white; border: none; border-radius: 5px; cursor: pointer;">
                    Coba Lagi
                </button>
            </div>
        `;
        iframe.parentNode.replaceChild(errorDiv, iframe);
    });
});
    </script>
</body>
</html>
